# 高级功能

探索 Nexion 的强大功能，让你的 SSH 管理更加高效和安全。

## 🔐 多重身份验证

### SSH 密钥管理

Nexion 支持多种 SSH 密钥格式：

```bash
# 支持的密钥类型
- RSA (2048, 3072, 4096 位)
- ECDSA (P-256, P-384, P-521)
- Ed25519 (推荐)
- DSA (已弃用，不建议使用)
```

### 密钥生成

在 Nexion 中生成新的 SSH 密钥对：

1. **打开密钥管理器**
   ```
   设置 → SSH 密钥 → 新建密钥对
   ```

2. **选择密钥类型**
   ```
   Ed25519 (推荐) - 安全性高，性能好
   RSA 4096     - 兼容性好，传统选择
   ECDSA P-256  - 平衡选择
   ```

3. **配置密钥选项**
   ```
   密钥名称: my-server-key
   密码保护: 建议启用
   有效期: 1年（可选）
   ```

### 硬件密钥支持

Nexion 支持硬件安全密钥：

- **YubiKey** - USB/NFC 硬件密钥
- **SoloKey** - 开源硬件密钥
- **Nitrokey** - 德国制造的硬件密钥

```
设置 → 硬件密钥 → 检测设备 → 配置密钥
```

## 🌐 跳板机配置

### 单级跳板机

通过跳板机连接内网服务器：

```yaml
# 配置示例
跳板机:
  主机: bastion.company.com
  端口: 22
  用户: jumpuser
  认证: SSH密钥

目标服务器:
  主机: 10.0.0.100
  端口: 22
  用户: root
  通过: 跳板机
```

### 多级跳板机

复杂网络环境下的多级跳转：

```yaml
路径: 本地 → 跳板机1 → 跳板机2 → 目标服务器

跳板机1:
  主机: gateway1.company.com
  端口: 22
  用户: user1

跳板机2:
  主机: gateway2.internal.com
  端口: 2222
  用户: user2
  通过: 跳板机1

目标服务器:
  主机: db-server.internal.com
  端口: 22
  用户: admin
  通过: 跳板机2
```

## 📜 自动化脚本

### 连接后脚本

连接成功后自动执行的命令：

```bash
# 示例：自动切换到工作目录并显示系统信息
cd /var/www/html
ls -la
df -h
top -n 1
```

### 环境变量设置

为每个连接预设环境变量：

```bash
export PROJECT_ROOT="/opt/myapp"
export NODE_ENV="production"
export DATABASE_URL="postgres://user:pass@localhost/db"
export PATH="$PATH:/usr/local/go/bin"
```

### 定时任务

设置定期执行的维护任务：

```yaml
任务名称: 数据库备份
服务器: 生产数据库
定时: 每天 02:00
脚本: |
  #!/bin/bash
  pg_dump myapp > /backup/$(date +%Y%m%d).sql
  aws s3 cp /backup/$(date +%Y%m%d).sql s3://myapp-backups/
```

## 📊 会话管理

### 会话保持

即使网络中断，也能恢复 SSH 会话：

```bash
# 自动使用 tmux/screen
会话类型: tmux (推荐)
会话名称: nexion-{timestamp}
自动恢复: 启用
保持时间: 24小时
```

### 会话共享

与团队成员共享终端会话：

```yaml
共享设置:
  权限: 只读/可写
  用户: team@company.com
  有效期: 2小时
  审计: 启用
```

### 会话录制

记录和回放终端会话：

```bash
录制格式: asciicast (asciinema)
存储位置: 区块链 + IPFS
加密: AES-256
保留期: 30天
```

## 🔄 配置同步

### 多设备同步

在不同设备间同步 SSH 配置：

```yaml
同步范围:
  - 服务器配置
  - SSH 密钥（加密）
  - 自定义脚本
  - 环境变量
  - 会话历史

同步方式:
  - 实时同步（推荐）
  - 手动同步
  - 定时同步
```

### 配置版本控制

跟踪配置更改历史：

```bash
# 查看配置历史
配置 → 版本历史 → 选择时间点 → 恢复

版本信息:
- 修改时间
- 修改内容
- 设备信息
- 区块链交易哈希
```

## 🔍 高级搜索

### 智能搜索

快速找到服务器和配置：

```
搜索语法:
- name:web*          # 按名称搜索
- host:192.168.*     # 按主机地址搜索  
- tag:production     # 按标签搜索
- user:root          # 按用户名搜索
- modified:>1d       # 按修改时间搜索
```

### 批量操作

对多个服务器执行批量操作：

```yaml
选择条件: tag:webserver AND environment:production
操作类型: 执行命令
命令: |
  sudo apt update && sudo apt upgrade -y
  systemctl restart nginx
  systemctl status nginx
```

## 🛡️ 安全功能

### 访问控制

精细的权限控制：

```yaml
角色权限:
  管理员:
    - 所有服务器访问
    - 配置管理
    - 用户管理
  
  开发者:
    - 开发服务器访问
    - 只读生产服务器
    - 自己的配置管理
  
  实习生:
    - 测试服务器访问
    - 有限的命令执行
```

### 审计日志

完整的操作审计：

```bash
记录内容:
- 登录/登出时间
- 执行的命令
- 文件访问记录
- 配置更改
- 异常行为

存储方式:
- 本地加密存储
- 区块链不可篡改记录
- 可选的第三方审计服务
```

### 异常检测

智能检测可疑活动：

```yaml
检测规则:
  - 异常登录时间
  - 可疑命令执行
  - 大量数据传输
  - 权限提升尝试
  - 多次登录失败

响应动作:
  - 发送告警通知
  - 临时锁定账户
  - 记录详细日志
  - 自动断开连接
```

## 🎨 界面定制

### 主题设置

自定义 Nexion 的外观：

```yaml
主题选项:
  - 暗色主题（默认）
  - 亮色主题
  - 高对比度主题
  - 自定义主题

终端主题:
  - Monokai
  - Solarized Dark/Light
  - Dracula
  - Custom CSS
```

### 布局配置

个性化工作界面：

```yaml
面板配置:
  - 服务器列表位置（左/右/隐藏）
  - 终端标签位置（顶部/底部）
  - 状态栏显示（显示/隐藏）
  - 快捷操作按钮

快捷键:
  - 自定义快捷键
  - Vim/Emacs 模式
  - 快速连接热键
```

## 📱 移动端支持

### PWA 应用

在移动设备上使用 Nexion：

```
功能支持:
✅ 服务器管理
✅ 基本 SSH 连接
✅ 配置同步
✅ 推送通知
⚠️ 完整终端功能（受限）
❌ 文件传输（计划中）
```

### 手机认证

使用手机作为二次认证：

```yaml
认证方式:
  - TOTP（Google Authenticator）
  - 推送通知确认
  - 生物识别（指纹/Face ID）
  - 短信验证码（不推荐）
```

## 🔌 插件系统

### 官方插件

扩展 Nexion 功能：

```yaml
可用插件:
  - Database Manager  # 数据库管理
  - File Browser      # 文件浏览器
  - System Monitor    # 系统监控
  - Git Integration   # Git 集成
  - Docker Manager    # Docker 管理
```

### 自定义插件

开发你own自己的插件：

```javascript
// 插件示例
class MyPlugin {
  constructor() {
    this.name = 'My Custom Plugin';
    this.version = '1.0.0';
  }
  
  onConnect(server) {
    console.log(`Connected to ${server.name}`);
  }
  
  addMenuItem() {
    return {
      label: '我的功能',
      action: this.myCustomAction
    };
  }
}
```

---

这些高级功能让 Nexion 不仅仅是一个 SSH 客户端，而是一个完整的服务器管理平台。继续阅读 [安全指南](/docs/security) 了解如何安全地使用这些功能。
