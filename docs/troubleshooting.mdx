# 故障排除

遇到问题？这里收集了常见问题的解决方案和诊断步骤。

## 🔧 连接问题

### SSH 连接失败

**问题现象：**
```
Connection failed: Connection refused
Error: ssh: connect to host 192.168.1.100 port 22: Connection refused
```

**排查步骤：**

1. **检查网络连通性**
   ```bash
   # 测试网络连通性
   ping 192.168.1.100
   
   # 检查端口是否开放
   telnet 192.168.1.100 22
   # 或使用 nmap
   nmap -p 22 192.168.1.100
   ```

2. **检查服务器 SSH 服务**
   ```bash
   # 在服务器上检查 SSH 服务状态
   sudo systemctl status ssh
   sudo systemctl status sshd
   
   # 重启 SSH 服务
   sudo systemctl restart ssh
   ```

3. **检查防火墙设置**
   ```bash
   # Ubuntu/Debian
   sudo ufw status
   sudo ufw allow 22
   
   # CentOS/RHEL
   sudo firewall-cmd --list-all
   sudo firewall-cmd --add-port=22/tcp --permanent
   sudo firewall-cmd --reload
   ```

### 认证失败

**问题现象：**
```
Permission denied (publickey)
```

**解决方案：**

1. **检查公钥是否正确部署**
   ```bash
   # 查看服务器上的公钥
   cat ~/.ssh/authorized_keys
   
   # 比较本地私钥对应的公钥
   ssh-keygen -y -f ~/.ssh/id_rsa
   ```

2. **检查文件权限**
   ```bash
   # 正确的权限设置
   chmod 700 ~/.ssh
   chmod 600 ~/.ssh/authorized_keys
   chmod 600 ~/.ssh/id_rsa
   chmod 644 ~/.ssh/id_rsa.pub
   ```

3. **检查 SSH 配置**
   ```bash
   # /etc/ssh/sshd_config
   PubkeyAuthentication yes
   AuthorizedKeysFile .ssh/authorized_keys
   ```

### 连接超时

**问题现象：**
```
ssh: connect to host example.com port 22: Operation timed out
```

**排查方法：**

1. **网络路径检查**
   ```bash
   # 路由跟踪
   traceroute example.com
   
   # MTU 检测
   ping -M do -s 1472 example.com
   ```

2. **DNS 解析检查**
   ```bash
   # 测试 DNS 解析
   nslookup example.com
   dig example.com
   
   # 使用 IP 直接连接测试
   ssh user@192.168.1.100
   ```

## 💰 支付和钱包问题

### 钱包连接失败

**问题现象：**
- 钱包连接按钮无响应
- 提示"未检测到钱包"
- 连接后立即断开

**解决步骤：**

1. **检查钱包插件**
   ```
   ✅ 确保已安装钱包插件 (OKX Wallet/MetaMask)
   ✅ 钱包插件已启用
   ✅ 钱包已解锁
   ✅ 浏览器允许弹窗
   ```

2. **网络配置**
   ```json
   // 检查网络设置
   {
     "网络名称": "OKX X Layer Mainnet",
     "RPC URL": "https://rpc.xlayer.tech",
     "Chain ID": "196",
     "Currency": "OKB"
   }
   ```

3. **清除缓存**
   ```
   浏览器设置 → 隐私和安全 → 清除浏览数据
   ☑️ Cookie 和网站数据
   ☑️ 缓存的图片和文件
   ```

### 余额不足

**问题现象：**
```
Transaction failed: insufficient funds for gas * price + value
```

**解决方案：**

1. **检查 OKB 余额**
   ```
   当前余额: 0.001 OKB
   所需费用: 0.002 OKB
   
   解决方案: 向钱包充值 OKB
   ```

2. **获取 OKB 代币**
   ```
   方式一: 从交易所转入 OKB 到你的钱包
   方式二: 使用跨链桥从其他网络转入
   方式三: 从其他钱包转入 OKB
   ```

3. **Gas 费用优化**
   ```
   标准费用: 0.0001 OKB
   快速确认: 0.0002 OKB
   经济模式: 0.00005 OKB (较慢)
   ```

### 交易确认慢

**问题现象：**
- 交易长时间处于 pending 状态
- 配置保存失败

**解决方法：**

1. **检查网络拥堵**
   ```
   访问区块链浏览器查看网络状态:
   https://www.okx.com/web3/explorer/xlayer
   ```

2. **提高 Gas 价格**
   ```
   设置 → 高级 → Gas 设置 → 手动设置
   建议 Gas Price: 根据网络状况调整
   ```

3. **重新发送交易**
   ```
   钱包 → 交易历史 → 找到 pending 交易
   → 加速交易 → 提高 Gas 费用
   ```

## 📱 应用程序问题

### 应用启动失败

**Windows 常见问题：**

1. **缺少运行库**
   ```
   错误: VCRUNTIME140.dll was not found
   
   解决方案:
   下载安装 Microsoft Visual C++ Redistributable
   ```

2. **权限不足**
   ```
   解决方案:
   右键 Nexion → 以管理员身份运行
   或移动到非系统目录
   ```

**macOS 常见问题：**

1. **应用被阻止**
   ```bash
   # 解除隔离
   sudo xattr -rd com.apple.quarantine /Applications/Nexion.app
   
   # 手动允许
   系统偏好设置 → 安全性与隐私 → 通用 → 允许
   ```

**Linux 常见问题：**

1. **依赖缺失**
   ```bash
   # Ubuntu/Debian
   sudo apt install libgtk-3-0 libnotify4 libnss3
   
   # CentOS/RHEL  
   sudo yum install gtk3 libnotify nss
   ```

### 界面显示异常

**问题现象：**
- 界面元素错位
- 字体显示异常
- 颜色异常

**解决方案：**

1. **重置界面设置**
   ```
   设置 → 界面 → 重置为默认设置
   ```

2. **清除应用数据**
   ```bash
   # Windows
   %APPDATA%\Nexion → 删除 config.json
   
   # macOS
   ~/Library/Application Support/Nexion → 删除 config.json
   
   # Linux  
   ~/.config/nexion → 删除 config.json
   ```

3. **更新显卡驱动**
   ```
   访问显卡厂商官网下载最新驱动:
   - NVIDIA: https://www.nvidia.com/drivers/
   - AMD: https://www.amd.com/support/
   - Intel: https://www.intel.com/content/www/us/en/support/
   ```

## 🔄 数据同步问题

### 配置丢失

**问题现象：**
- 服务器配置列表为空
- 之前的配置突然消失

**排查步骤：**

1. **检查钱包地址**
   ```
   当前钱包地址: 0x1234...abcd
   配置存储地址: 0x5678...efgh
   
   问题: 钱包地址不匹配
   解决: 切换到正确的钱包地址
   ```

2. **检查网络连接**
   ```bash
   # 测试区块链节点连接
   curl -X POST https://rpc.xlayer.tech \
     -H "Content-Type: application/json" \
     -d '{"jsonrpc":"2.0","method":"eth_blockNumber","params":[],"id":1}'
   ```

3. **强制同步**
   ```
   设置 → 数据同步 → 清除本地缓存 → 重新同步
   ```

### 同步冲突

**问题现象：**
```
Sync conflict detected: local changes conflict with remote changes
```

**解决方案：**

1. **查看冲突详情**
   ```
   设置 → 数据同步 → 查看冲突
   
   本地更改:
   - server-01: 修改了端口 22 → 2222
   
   远程更改:  
   - server-01: 修改了用户名 root → admin
   ```

2. **选择解决策略**
   ```
   策略一: 保留本地更改 (覆盖远程)
   策略二: 使用远程更改 (覆盖本地)  
   策略三: 合并更改 (手动解决冲突)
   策略四: 创建新配置 (保留两个版本)
   ```

## 🐛 调试和日志

### 启用调试模式

**方法一：命令行启动**
```bash
# Windows
Nexion.exe --debug --log-level=debug

# macOS/Linux  
nexion --debug --log-level=debug
```

**方法二：环境变量**
```bash
export NEXION_DEBUG=true
export NEXION_LOG_LEVEL=debug
```

**方法三：配置文件**
```json
{
  "debug": true,
  "logLevel": "debug",
  "logFile": "nexion-debug.log"
}
```

### 查看日志文件

**日志位置：**
```bash
# Windows
%APPDATA%\Nexion\logs\nexion.log

# macOS
~/Library/Logs/Nexion/nexion.log

# Linux
~/.config/nexion/logs/nexion.log
```

**日志分析：**
```bash
# 查看连接错误
grep "ERROR.*connection" nexion.log

# 查看认证问题
grep "auth" nexion.log

# 查看最近 100 行
tail -n 100 nexion.log
```

### 生成诊断报告

```bash
# 自动生成诊断报告
nexion --generate-diagnostic-report

报告内容:
✅ 系统信息
✅ 网络配置  
✅ 钱包状态
✅ 最近错误日志
✅ 配置文件状态
❌ 敏感信息 (已排除)
```

## 📞 获取帮助

### 自助诊断

1. **内置诊断工具**
   ```
   帮助 → 系统诊断 → 运行自动检测
   ```

2. **网络连接测试**
   ```
   帮助 → 网络测试 → 测试所有连接
   ```

3. **配置验证**
   ```
   帮助 → 配置检查 → 验证所有设置
   ```

### 社区支持

- **GitHub Issues**: [https://github.com/AceXiamo/Nexion/issues](https://github.com/AceXiamo/Nexion/issues)
- **社区论坛**: [https://community.nexion.app](https://community.nexion.app)  
- **Telegram 群**: [@NexionSupport](https://t.me/NexionSupport)
- **Discord**: [https://discord.gg/nexion](https://discord.gg/nexion)

### 技术支持

**联系方式：**
- 📧 邮件：support@nexion.app
- 💬 在线客服：周一至周五 9:00-18:00 (UTC+8)
- 🚨 紧急支持：security@nexion.app

**提交问题时请包含：**
```
1. 操作系统和版本
2. Nexion 版本号
3. 问题详细描述
4. 重现步骤
5. 错误日志 (脱敏后)
6. 诊断报告 (如果可能)
```

---

如果以上方法都无法解决你的问题，请不要犹豫联系我们的技术支持团队。我们会尽快帮你解决问题！
